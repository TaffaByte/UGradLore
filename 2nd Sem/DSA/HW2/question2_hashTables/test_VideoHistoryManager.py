import pytest
from VideoHistoryManager import *




def test_main():
    assert(main("watchedVideos.csv") == [{'Video_ID': '88F7B33d2bcf9f5', 'Video_URL': 'https://StreamSphere.com/watch?v=88F7B33d2bcf9f5', 'Views': 664320, 'Likes': 43580, 'Dislikes': 1234}, {'Video_ID': 'f90cD3E76f1A9b9', 'Video_URL': 'https://StreamSphere.com/watch?v=f90cD3E76f1A9b9', 'Views': 749879, 'Likes': 46935, 'Dislikes': 3456}, {'Video_ID': 'DbeAb8CcdfeFC2c', 'Video_URL': 'https://StreamSphere.com/watch?v=DbeAb8CcdfeFC2c', 'Views': 653568, 'Likes': 32921, 'Dislikes': 23}, {'Video_ID': 'A31Bee3c201ef58', 'Video_URL': 'https://StreamSphere.com/watch?v=A31Bee3c201ef58', 'Views': 861413, 'Likes': 27121, 'Dislikes': 21}, {'Video_ID': '1bA7A3dc874da3c', 'Video_URL': 'https://StreamSphere.com/watch?v=1bA7A3dc874da3c', 'Views': 860201, 'Likes': 11137, 'Dislikes': 784}, {'Video_ID': 'bfDD7CDEF5D865B', 'Video_URL': 'https://StreamSphere.com/watch?v=bfDD7CDEF5D865B', 'Views': 787966, 'Likes': 7603, 'Dislikes': 647}, {'Video_ID': 'bE9EEf34cB72AF7', 'Video_URL': 'https://StreamSphere.com/watch?v=bE9EEf34cB72AF7', 'Views': 2317, 'Likes': 21657, 'Dislikes': 76437}, {'Video_ID': '2EFC6A4e77FaEaC', 'Video_URL': 'https://StreamSphere.com/watch?v=2EFC6A4e77FaEaC', 'Views': 650908, 'Likes': 43194, 'Dislikes': 422}, {'Video_ID': 'baDcC4DeefD8dEB', 'Video_URL': 'https://StreamSphere.com/watch?v=baDcC4DeefD8dEB', 'Views': 152937, 'Likes': 17005, 'Dislikes': 8993}, {'Video_ID': '8e4FB470FE19bF0', 'Video_URL': 'https://StreamSphere.com/watch?v=8e4FB470FE19bF0', 'Views': 570487, 'Likes': 6369, 'Dislikes': 249}])

def test_create_studentDatabase():
    assert(create_VideoHistory([{'Video_ID': '88F7B33d2bcf9f5', 'Video_URL': 'https://StreamSphere.com/watch?v=88F7B33d2bcf9f5', 'Views': 664320, 'Likes': 43580, 'Dislikes': 1234}, {'Video_ID': 'f90cD3E76f1A9b9', 'Video_URL': 'https://StreamSphere.com/watch?v=f90cD3E76f1A9b9', 'Views': 749879, 'Likes': 46935, 'Dislikes': 3456}, {'Video_ID': 'DbeAb8CcdfeFC2c', 'Video_URL': 'https://StreamSphere.com/watch?v=DbeAb8CcdfeFC2c', 'Views': 653568, 'Likes': 32921, 'Dislikes': 23}, {'Video_ID': 'A31Bee3c201ef58', 'Video_URL': 'https://StreamSphere.com/watch?v=A31Bee3c201ef58', 'Views': 861413, 'Likes': 27121, 'Dislikes': 21}, {'Video_ID': '1bA7A3dc874da3c', 'Video_URL': 'https://StreamSphere.com/watch?v=1bA7A3dc874da3c', 'Views': 860201, 'Likes': 11137, 'Dislikes': 784}, {'Video_ID': 'bfDD7CDEF5D865B', 'Video_URL': 'https://StreamSphere.com/watch?v=bfDD7CDEF5D865B', 'Views': 787966, 'Likes': 7603, 'Dislikes': 647}, {'Video_ID': 'bE9EEf34cB72AF7', 'Video_URL': 'https://StreamSphere.com/watch?v=bE9EEf34cB72AF7', 'Views': 2317, 'Likes': 21657, 'Dislikes': 76437}, {'Video_ID': '2EFC6A4e77FaEaC', 'Video_URL': 'https://StreamSphere.com/watch?v=2EFC6A4e77FaEaC', 'Views': 650908, 'Likes': 43194, 'Dislikes': 422}, {'Video_ID': 'baDcC4DeefD8dEB', 'Video_URL': 'https://StreamSphere.com/watch?v=baDcC4DeefD8dEB', 'Views': 152937, 'Likes': 17005, 'Dislikes': 8993}, {'Video_ID': '8e4FB470FE19bF0', 'Video_URL': 'https://StreamSphere.com/watch?v=8e4FB470FE19bF0', 'Views': 570487, 'Likes': 6369, 'Dislikes': 249}])==([{'ID': '1bA7A3dc874da3c', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=1bA7A3dc874da3c', 'Views': 860201, 'Likes': 11137, 'Dislikes': 784}}, {'ID': None, 'DATA': None}, {'ID': '8e4FB470FE19bF0', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=8e4FB470FE19bF0', 'Views': 570487, 'Likes': 6369, 'Dislikes': 249}}, {'ID': None, 'DATA': None}, {'ID': None, 'DATA': None}, {'ID': 'bE9EEf34cB72AF7', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=bE9EEf34cB72AF7', 'Views': 2317, 'Likes': 21657, 'Dislikes': 76437}}, {'ID': '2EFC6A4e77FaEaC', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=2EFC6A4e77FaEaC', 'Views': 650908, 'Likes': 43194, 'Dislikes': 422}}, {'ID': 'baDcC4DeefD8dEB', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=baDcC4DeefD8dEB', 'Views': 152937, 'Likes': 17005, 'Dislikes': 8993}}, {'ID': None, 'DATA': None}, {'ID': 'DbeAb8CcdfeFC2c', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=DbeAb8CcdfeFC2c', 'Views': 653568, 'Likes': 32921, 'Dislikes': 23}}, {'ID': None, 'DATA': None}, {'ID': None, 'DATA': None}, {'ID': 'bfDD7CDEF5D865B', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=bfDD7CDEF5D865B', 'Views': 787966, 'Likes': 7603, 'Dislikes': 647}}, {'ID': 'f90cD3E76f1A9b9', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=f90cD3E76f1A9b9', 'Views': 749879, 'Likes': 46935, 'Dislikes': 3456}}, {'ID': 'A31Bee3c201ef58', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=A31Bee3c201ef58', 'Views': 861413, 'Likes': 27121, 'Dislikes': 21}}, {'ID': '88F7B33d2bcf9f5', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=88F7B33d2bcf9f5', 'Views': 664320, 'Likes': 43580, 'Dislikes': 1234}}, {'ID': None, 'DATA': None}]))

def test_perform_Operations1():
     assert(perform_Operations([{'ID': '1bA7A3dc874da3c', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=1bA7A3dc874da3c', 'Views': 860201, 'Likes': 11137, 'Dislikes': 784}}, {'ID': None, 'DATA': None}, {'ID': '8e4FB470FE19bF0', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=8e4FB470FE19bF0', 'Views': 570487, 'Likes': 6369, 'Dislikes': 249}}, {'ID': None, 'DATA': None}, {'ID': None, 'DATA': None}, {'ID': 'bE9EEf34cB72AF7', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=bE9EEf34cB72AF7', 'Views': 2317, 'Likes': 21657, 'Dislikes': 76437}}, {'ID': '2EFC6A4e77FaEaC', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=2EFC6A4e77FaEaC', 'Views': 650908, 'Likes': 43194, 'Dislikes': 422}}, {'ID': 'baDcC4DeefD8dEB', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=baDcC4DeefD8dEB', 'Views': 152937, 'Likes': 17005, 'Dislikes': 8993}}, {'ID': None, 'DATA': None}, {'ID': 'DbeAb8CcdfeFC2c', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=DbeAb8CcdfeFC2c', 'Views': 653568, 'Likes': 32921, 'Dislikes': 23}}, {'ID': None, 'DATA': None}, {'ID': None, 'DATA': None}, {'ID': 'bfDD7CDEF5D865B', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=bfDD7CDEF5D865B', 'Views': 787966, 'Likes': 7603, 'Dislikes': 647}}, {'ID': 'f90cD3E76f1A9b9', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=f90cD3E76f1A9b9', 'Views': 749879, 'Likes': 46935, 'Dislikes': 3456}}, {'ID': 'A31Bee3c201ef58', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=A31Bee3c201ef58', 'Views': 861413, 'Likes': 27121, 'Dislikes': 21}}, {'ID': '88F7B33d2bcf9f5', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=88F7B33d2bcf9f5', 'Views': 664320, 'Likes': 43580, 'Dislikes': 1234}}, {'ID': None, 'DATA': None}],'Operations1.csv')==(({1: [9], 2: [15], 3: [9], 4: [0], 5: [9, 14, 2], 6: [7], 7: [9, 14, 2], 8: [9, 14, 2, 7, 12, 0, 5, 10], 9: [13, 5], 10: [13, 6]},[{'ID': '1bA7A3dc874da3c', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=1bA7A3dc874da3c', 'Views': 860201, 'Likes': 11138, 'Dislikes': 784}}, {'ID': None, 'DATA': None}, {'ID': '#', 'DATA': '#'}, {'ID': None, 'DATA': None}, {'ID': None, 'DATA': None}, {'ID': 'bE9EEf34cB72AF7', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=bE9EEf34cB72AF7', 'Views': 2318, 'Likes': 21657, 'Dislikes': 76437}}, {'ID': '2EFC6A4e77FaEaC', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=2EFC6A4e77FaEaC', 'Views': 650908, 'Likes': 43194, 'Dislikes': 423}}, {'ID': 'baDcC4DeefD8dEB', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=baDcC4DeefD8dEB', 'Views': 152937, 'Likes': 17006, 'Dislikes': 8993}}, {'ID': None, 'DATA': None}, {'ID': 'DbeAb8CcdfeFC2c', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=DbeAb8CcdfeFC2c', 'Views': 653570, 'Likes': 32921, 'Dislikes': 23}}, {'ID': '8e4FB470FE19bF1', 'DATA': {'Video_URL': 'https://fakevideo.com/watch?v=8e4FB470FE19bF1', 'Views': 570488, 'Likes': '6369', 'Dislikes': '249'}}, {'ID': None, 'DATA': None}, {'ID': 'bfDD7CDEF5D865B', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=bfDD7CDEF5D865B', 'Views': 787966, 'Likes': 7603, 'Dislikes': 647}}, {'ID': 'f90cD3E76f1A9b9', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=f90cD3E76f1A9b9', 'Views': 749879, 'Likes': 46935, 'Dislikes': 3456}}, {'ID': 'A31Bee3c201ef58', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=A31Bee3c201ef58', 'Views': 861413, 'Likes': 27121, 'Dislikes': 21}}, {'ID': '88F7B33d2bcf9f5', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=88F7B33d2bcf9f5', 'Views': 664321, 'Likes': 43580, 'Dislikes': 1234}}, {'ID': None, 'DATA': None}])))
    
def test_perform_Operations2():
     assert(perform_Operations([{'ID': '1bA7A3dc874da3c', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=1bA7A3dc874da3c', 'Views': 860201, 'Likes': 11137, 'Dislikes': 784}}, {'ID': None, 'DATA': None}, {'ID': '8e4FB470FE19bF0', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=8e4FB470FE19bF0', 'Views': 570487, 'Likes': 6369, 'Dislikes': 249}}, {'ID': None, 'DATA': None}, {'ID': None, 'DATA': None}, {'ID': 'bE9EEf34cB72AF7', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=bE9EEf34cB72AF7', 'Views': 2317, 'Likes': 21657, 'Dislikes': 76437}}, {'ID': '2EFC6A4e77FaEaC', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=2EFC6A4e77FaEaC', 'Views': 650908, 'Likes': 43194, 'Dislikes': 422}}, {'ID': 'baDcC4DeefD8dEB', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=baDcC4DeefD8dEB', 'Views': 152937, 'Likes': 17005, 'Dislikes': 8993}}, {'ID': None, 'DATA': None}, {'ID': 'DbeAb8CcdfeFC2c', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=DbeAb8CcdfeFC2c', 'Views': 653568, 'Likes': 32921, 'Dislikes': 23}}, {'ID': None, 'DATA': None}, {'ID': None, 'DATA': None}, {'ID': 'bfDD7CDEF5D865B', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=bfDD7CDEF5D865B', 'Views': 787966, 'Likes': 7603, 'Dislikes': 647}}, {'ID': 'f90cD3E76f1A9b9', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=f90cD3E76f1A9b9', 'Views': 749879, 'Likes': 46935, 'Dislikes': 3456}}, {'ID': 'A31Bee3c201ef58', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=A31Bee3c201ef58', 'Views': 861413, 'Likes': 27121, 'Dislikes': 21}}, {'ID': '88F7B33d2bcf9f5', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=88F7B33d2bcf9f5', 'Views': 664320, 'Likes': 43580, 'Dislikes': 1234}}, {'ID': None, 'DATA': None}],'Operations2.csv')==({1: [9], 2: [15], 3: [9], 4: [0], 5: [9, 14, 2], 6: [7], 7: [9, 14, 2], 8: [9, 14, 2, 7, 12, 0, 5, 10], 9: [13, 5], 10: [13, 6]},[{'ID': '1bA7A3dc874da3c', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=1bA7A3dc874da3c', 'Views': 860201, 'Likes': 11138, 'Dislikes': 784}}, {'ID': None, 'DATA': None}, {'ID': '#', 'DATA': '#'}, {'ID': None, 'DATA': None}, {'ID': None, 'DATA': None}, {'ID': '#', 'DATA': '#'}, {'ID': '#', 'DATA': '#'}, {'ID': 'baDcC4DeefD8dEB', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=baDcC4DeefD8dEB', 'Views': 152937, 'Likes': 17006, 'Dislikes': 8993}}, {'ID': None, 'DATA': None}, {'ID': 'DbeAb8CcdfeFC2c', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=DbeAb8CcdfeFC2c', 'Views': 653570, 'Likes': 32921, 'Dislikes': 23}}, {'ID': None, 'DATA': None}, {'ID': None, 'DATA': None}, {'ID': 'bfDD7CDEF5D865B', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=bfDD7CDEF5D865B', 'Views': 787966, 'Likes': 7603, 'Dislikes': 647}}, {'ID': 'f90cD3E76f1A9b9', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=f90cD3E76f1A9b9', 'Views': 749879, 'Likes': 46935, 'Dislikes': 3456}}, {'ID': 'A31Bee3c201ef58', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=A31Bee3c201ef58', 'Views': 861413, 'Likes': 27121, 'Dislikes': 21}}, {'ID': '88F7B33d2bcf9f5', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=88F7B33d2bcf9f5', 'Views': 664321, 'Likes': 43580, 'Dislikes': 1234}}, {'ID': None, 'DATA': None}]))
   
def test_perform_Operations3():
     assert(perform_Operations([{'ID': '1bA7A3dc874da3c', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=1bA7A3dc874da3c', 'Views': 860201, 'Likes': 11137, 'Dislikes': 784}}, {'ID': None, 'DATA': None}, {'ID': '8e4FB470FE19bF0', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=8e4FB470FE19bF0', 'Views': 570487, 'Likes': 6369, 'Dislikes': 249}}, {'ID': None, 'DATA': None}, {'ID': None, 'DATA': None}, {'ID': 'bE9EEf34cB72AF7', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=bE9EEf34cB72AF7', 'Views': 2317, 'Likes': 21657, 'Dislikes': 76437}}, {'ID': '2EFC6A4e77FaEaC', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=2EFC6A4e77FaEaC', 'Views': 650908, 'Likes': 43194, 'Dislikes': 422}}, {'ID': 'baDcC4DeefD8dEB', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=baDcC4DeefD8dEB', 'Views': 152937, 'Likes': 17005, 'Dislikes': 8993}}, {'ID': None, 'DATA': None}, {'ID': 'DbeAb8CcdfeFC2c', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=DbeAb8CcdfeFC2c', 'Views': 653568, 'Likes': 32921, 'Dislikes': 23}}, {'ID': None, 'DATA': None}, {'ID': None, 'DATA': None}, {'ID': 'bfDD7CDEF5D865B', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=bfDD7CDEF5D865B', 'Views': 787966, 'Likes': 7603, 'Dislikes': 647}}, {'ID': 'f90cD3E76f1A9b9', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=f90cD3E76f1A9b9', 'Views': 749879, 'Likes': 46935, 'Dislikes': 3456}}, {'ID': 'A31Bee3c201ef58', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=A31Bee3c201ef58', 'Views': 861413, 'Likes': 27121, 'Dislikes': 21}}, {'ID': '88F7B33d2bcf9f5', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=88F7B33d2bcf9f5', 'Views': 664320, 'Likes': 43580, 'Dislikes': 1234}}, {'ID': None, 'DATA': None}],'Operations3.csv')==({1: [9], 2: [15], 3: [9], 4: [0], 5: [9, 14, 2], 6: [7], 7: [9, 14, 2], 8: [13, 5], 9: [13, 6], 10: [13], 11: [14], 12: [2], 13: [0], 14: [3]}, [{'ID': 'bfDD7CDEF5D865B', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=bfDD7CDEF5D865B', 'Views': 787966, 'Likes': 7603, 'Dislikes': 647}}, {'ID': None, 'DATA': None}, {'ID': None, 'DATA': None}, {'ID': '#', 'DATA': '#'}, {'ID': None, 'DATA': None}, {'ID': 'baDcC4DeefD8dEB', 'DATA': {'Video_URL': 'https://StreamSphere.com/watch?v=baDcC4DeefD8dEB', 'Views': 152937, 'Likes': 17006, 'Dislikes': 8993}}, {'ID': None, 'DATA': None}]))
